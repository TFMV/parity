{"level":"info","ts":1740038493.463649,"caller":"validation/validator_test.go:112","msg":"Starting schema validation","table":"test"}
{"level":"info","ts":1740038493.464829,"caller":"validation/validator_test.go:112","msg":"Schema validation passed","table":"test"}
{"level":"info","ts":1740038493.477046,"caller":"validation/validator_test.go:133","msg":"Starting schema validation","table":"test"}
{"level":"warn","ts":1740038493.477437,"caller":"validation/validator_test.go:133","msg":"Schema validation failed","table":"test","missingInDestination":["value"],"missingInSource":["different_column"],"dataTypeMismatches":{}}
{"level":"info","ts":1740038493.4899352,"caller":"validation/validator_test.go:156","msg":"Starting row count validation","table":"test"}
{"level":"info","ts":1740038493.491041,"caller":"validation/validator_test.go:156","msg":"Row count validation passed","source":2,"destination":2}
{"level":"info","ts":1740038493.5008,"caller":"validation/validator_test.go:182","msg":"Starting row count validation","table":"test"}
{"level":"warn","ts":1740038493.5012531,"caller":"validation/validator_test.go:182","msg":"Row count validation failed","source":2,"destination":1,"difference":1}
{"level":"info","ts":1740038493.511061,"caller":"validation/validator_test.go:211","msg":"Starting full validation","table":"test"}
{"level":"info","ts":1740038493.5111308,"caller":"validation/validator.go:71","msg":"Starting value-level validation","table":"test","mode":"Full"}
{"level":"info","ts":1740038493.511186,"caller":"validation/validator.go:61","msg":"Starting row count validation","table":"test"}
{"level":"info","ts":1740038493.511201,"caller":"validation/validator.go:66","msg":"Starting aggregate validation","table":"test"}
{"level":"info","ts":1740038493.51125,"caller":"validation/validator.go:56","msg":"Starting schema validation","table":"test"}
{"level":"info","ts":1740038493.5116742,"caller":"validation/validator.go:61","msg":"Row count validation passed","source":2,"destination":2}
{"level":"info","ts":1740038493.5116858,"caller":"validation/validator.go:56","msg":"Schema validation passed","table":"test"}
{"level":"error","ts":1740038493.511751,"caller":"validation/validator.go:66","msg":"Failed to get source aggregates","column":"id","error":"unsupported data type for numeric extraction: decimal"}
{"level":"info","ts":1740038493.511809,"caller":"validation/validator.go:71","msg":"Value-level validation passed","sampledRows":2}
{"level":"error","ts":1740038493.5118542,"caller":"validation/validator_test.go:211","msg":"Validation errors encountered","error":"unsupported data type for numeric extraction: decimal"}
{"level":"info","ts":1740038602.13907,"caller":"validation/validator_test.go:113","msg":"Starting schema validation","table":"test"}
{"level":"info","ts":1740038602.140248,"caller":"validation/validator_test.go:113","msg":"Schema validation passed","table":"test"}
{"level":"info","ts":1740038602.15153,"caller":"validation/validator_test.go:134","msg":"Starting schema validation","table":"test"}
{"level":"warn","ts":1740038602.1519942,"caller":"validation/validator_test.go:134","msg":"Schema validation failed","table":"test","missingInDestination":["value"],"missingInSource":["different_column"],"dataTypeMismatches":{}}
{"level":"info","ts":1740038602.164335,"caller":"validation/validator_test.go:157","msg":"Starting row count validation","table":"test"}
{"level":"info","ts":1740038602.165586,"caller":"validation/validator_test.go:157","msg":"Row count validation passed","source":2,"destination":2}
{"level":"info","ts":1740038602.1759338,"caller":"validation/validator_test.go:183","msg":"Starting row count validation","table":"test"}
{"level":"warn","ts":1740038602.176339,"caller":"validation/validator_test.go:183","msg":"Row count validation failed","source":2,"destination":1,"difference":1}
{"level":"info","ts":1740038602.1862772,"caller":"validation/validator_test.go:215","msg":"Starting full validation","table":"test"}
{"level":"info","ts":1740038602.186332,"caller":"validation/validator.go:71","msg":"Starting value-level validation","table":"test","mode":"Full"}
{"level":"info","ts":1740038602.186385,"caller":"validation/validator.go:66","msg":"Starting aggregate validation","table":"test"}
{"level":"info","ts":1740038602.186378,"caller":"validation/validator.go:61","msg":"Starting row count validation","table":"test"}
{"level":"info","ts":1740038602.1864588,"caller":"validation/validator.go:56","msg":"Starting schema validation","table":"test"}
{"level":"info","ts":1740038602.186985,"caller":"validation/validator.go:56","msg":"Schema validation passed","table":"test"}
{"level":"info","ts":1740038602.18703,"caller":"validation/validator.go:61","msg":"Row count validation passed","source":2,"destination":2}
{"level":"info","ts":1740038602.1870348,"caller":"validation/validator.go:71","msg":"Value-level validation passed","sampledRows":2}
{"level":"info","ts":1740038602.1872692,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"id","aggType":"SUM"}
{"level":"info","ts":1740038602.1872818,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"id","aggType":"AVG"}
{"level":"info","ts":1740038602.187288,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"id","aggType":"MIN"}
{"level":"info","ts":1740038602.187294,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"id","aggType":"MAX"}
{"level":"info","ts":1740038602.187298,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"id","aggType":"COUNT"}
{"level":"info","ts":1740038602.187819,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"value","aggType":"SUM"}
{"level":"info","ts":1740038602.1878452,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"value","aggType":"AVG"}
{"level":"info","ts":1740038602.187853,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"value","aggType":"MIN"}
{"level":"info","ts":1740038602.1878579,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"value","aggType":"MAX"}
{"level":"info","ts":1740038602.187864,"caller":"validation/validator.go:66","msg":"Aggregate validation passed","column":"value","aggType":"COUNT"}
{"level":"info","ts":1740038602.188106,"caller":"validation/validator_test.go:215","msg":"Validation report generated","report":"{\n  \"db_metadata\": {\n    \"source_db_name\": \"SourceDB\",\n    \"destination_db_name\": \"DestinationDB\",\n    \"engine\": \"Apache Arrow ADBC\",\n    \"version\": \"1.0\",\n    \"schema_name\": \"\",\n    \"start_time\": \"2025-02-20T02:03:22.186277-06:00\",\n    \"end_time\": \"2025-02-20T02:03:22.187874-06:00\",\n    \"duration\": 1597584,\n    \"connection_string\": \"\",\n    \"validation_thresholds\": {\n      \"numeric_difference_tolerance\": 0.001,\n      \"row_count_tolerance\": 0,\n      \"sampling_confidence_level\": 0.95\n    },\n    \"total_partitions\": 0,\n    \"total_shards\": 0\n  },\n  \"table_metadata\": {\n    \"object_type\": \"table\",\n    \"name\": \"test\",\n    \"primary_keys\": [],\n    \"num_columns\": 0,\n    \"column_data_types\": {},\n    \"partition_strategy\": \"\",\n    \"sharding_strategy\": \"\"\n  },\n  \"row_count_result\": {\n    \"source_count\": 2,\n    \"destination_count\": 2,\n    \"difference\": 0,\n    \"status\": true\n  },\n  \"aggregate_results\": [\n    {\n      \"column_name\": \"id\",\n      \"agg_type\": \"SUM\",\n      \"source_value\": 3,\n      \"destination_value\": 3,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"id\",\n      \"agg_type\": \"AVG\",\n      \"source_value\": 1.5,\n      \"destination_value\": 1.5,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"id\",\n      \"agg_type\": \"MIN\",\n      \"source_value\": 1,\n      \"destination_value\": 1,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"id\",\n      \"agg_type\": \"MAX\",\n      \"source_value\": 2,\n      \"destination_value\": 2,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"id\",\n      \"agg_type\": \"COUNT\",\n      \"source_value\": 2,\n      \"destination_value\": 2,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"value\",\n      \"agg_type\": \"SUM\",\n      \"source_value\": 31,\n      \"destination_value\": 31,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"value\",\n      \"agg_type\": \"AVG\",\n      \"source_value\": 15.5,\n      \"destination_value\": 15.5,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"value\",\n      \"agg_type\": \"MIN\",\n      \"source_value\": 10.5,\n      \"destination_value\": 10.5,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"value\",\n      \"agg_type\": \"MAX\",\n      \"source_value\": 20.5,\n      \"destination_value\": 20.5,\n      \"difference\": 0,\n      \"status\": true\n    },\n    {\n      \"column_name\": \"value\",\n      \"agg_type\": \"COUNT\",\n      \"source_value\": 2,\n      \"destination_value\": 2,\n      \"difference\": 0,\n      \"status\": true\n    }\n  ],\n  \"value_result\": {\n    \"mode\": \"Full\",\n    \"sampling_percentage\": 100,\n    \"sampled_rows\": 2,\n    \"mismatched_rows\": 0,\n    \"columns_compared\": [\n      \"id\",\n      \"value\"\n    ],\n    \"mismatched_data\": {},\n    \"status\": true\n  },\n  \"schema_result\": {\n    \"result\": true,\n    \"missing_in_destination\": null,\n    \"missing_in_source\": null,\n    \"data_type_mismatches\": {},\n    \"primary_key_differences\": [],\n    \"status\": true\n  },\n  \"partition_metrics\": [],\n  \"shard_metrics\": []\n}"}
{"level":"info","ts":1740038602.1882188,"caller":"validation/validator_test.go:215","msg":"Validation completed","duration":0.001597584}
